<!DOCTYPE html>
<html>
<head>
    <title>Redirecionando...</title>
    <script>
        // Extrair parâmetros da URL (conforme documentação Supabase)
        const urlParams = new URLSearchParams(window.location.search);
        const token = urlParams.get('token_hash') || urlParams.get('access_token') || urlParams.get('token');
        const type = urlParams.get('type');
        
        if (token && type === 'recovery') {
            // Tentar abrir a app
            const deepLink = `com.example.goetales://auth/callback?type=${type}&token_hash=${token}`;
            window.location.href = deepLink;
            
            // Fallback: mostrar instruções se não abrir
            setTimeout(() => {
                document.body.innerHTML = `
                    <h2>Abrir no App GoeTales</h2>
                    <p>Se o app não abriu automaticamente, toque no link:</p>
                    <a href="${deepLink}">Abrir GoeTales</a>
                    <p>Ou copie este link: ${deepLink}</p>
                `;
            }, 1000);
        } else {
            document.body.innerHTML = '<p>Parâmetros inválidos. Verifique o link.</p>';
        }
    </script>
</head>
<body>
    <p>Redirecionando para o app...</p>
</body>
</html>
